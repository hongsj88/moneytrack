# ğŸ”§ MoneyTrack Supabase ì„¤ì • ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” MoneyTrack ì•±ì„ ìœ„í•œ Supabase ë°±ì—”ë“œ ì„¤ì • ë°©ë²•ì„ ë‹¨ê³„ë³„ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

- [Supabase](https://supabase.com) ê³„ì •
- í”„ë¡œì íŠ¸ ì†ŒìŠ¤ ì½”ë“œ
- ê¸°ë³¸ì ì¸ SQL ì§€ì‹ (ì„ íƒì‚¬í•­)

## ğŸš€ 1ë‹¨ê³„: Supabase í”„ë¡œì íŠ¸ ìƒì„±

### 1.1 ê³„ì • ìƒì„± ë° ë¡œê·¸ì¸
1. [Supabase](https://supabase.com)ì— ì ‘ì†
2. "Start your project" í´ë¦­
3. GitHub/Google ê³„ì •ìœ¼ë¡œ ê°€ì… ë˜ëŠ” ë¡œê·¸ì¸

### 1.2 ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
1. ëŒ€ì‹œë³´ë“œì—ì„œ "New Project" í´ë¦­
2. Organization ì„ íƒ (ê°œì¸ ê³„ì • ì‚¬ìš© ê¶Œì¥)
3. í”„ë¡œì íŠ¸ ì •ë³´ ì…ë ¥:
   - **Name**: `MoneyTrack` (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)
   - **Database Password**: ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ìƒì„± (ìë™ ìƒì„± ê¶Œì¥)
   - **Region**: `Seoul (ap-northeast-1)` (í•œêµ­ ì‚¬ìš©ìì˜ ê²½ìš°)
4. "Create new project" í´ë¦­
5. í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œê¹Œì§€ 1-2ë¶„ ëŒ€ê¸°

## âš™ï¸ 2ë‹¨ê³„: API í‚¤ í™•ì¸

### 2.1 í”„ë¡œì íŠ¸ ì„¤ì • ì ‘ê·¼
1. í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œì—ì„œ ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì˜ "Settings" í´ë¦­
2. "API" ë©”ë‰´ ì„ íƒ

### 2.2 í•„ìˆ˜ ì •ë³´ ë³µì‚¬
ë‹¤ìŒ ì •ë³´ë¥¼ ë©”ëª¨ì¥ì— ë³µì‚¬í•´ë‘ì„¸ìš”:

```
Project URL: https://your-project-id.supabase.co
anon public key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

âš ï¸ **ì£¼ì˜**: `service_role` í‚¤ëŠ” ì„œë²„ ì‚¬ì´ë“œì—ì„œë§Œ ì‚¬ìš©í•˜ë©°, í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œí•˜ë©´ ì•ˆë©ë‹ˆë‹¤.

## ğŸ—„ï¸ 3ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ì •

### 3.1 SQL Editor ì ‘ê·¼
1. ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ "SQL Editor" í´ë¦­
2. "New query" ë²„íŠ¼ í´ë¦­

### 3.2 ìŠ¤í‚¤ë§ˆ ì‹¤í–‰
1. `database/schema.sql` íŒŒì¼ì˜ ì „ì²´ ë‚´ìš©ì„ ë³µì‚¬
2. SQL Editorì— ë¶™ì—¬ë„£ê¸°
3. "Run" ë²„íŠ¼ í´ë¦­ (ë˜ëŠ” Ctrl+Enter)

### 3.3 ì‹¤í–‰ ê²°ê³¼ í™•ì¸
ì„±ê³µì‹œ ë‹¤ìŒê³¼ ê°™ì€ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤:
```
Success. No rows returned
```

ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ìŠ¤í‚¤ë§ˆë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ê³  ì¬ì‹¤í–‰í•˜ì„¸ìš”.

## ğŸ” 4ë‹¨ê³„: í…Œì´ë¸” ìƒì„± í™•ì¸

### 4.1 Table Editorì—ì„œ í™•ì¸
1. ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ "Table Editor" í´ë¦­
2. ë‹¤ìŒ í…Œì´ë¸”ë“¤ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸:
   - `users`
   - `categories` (4ê°œ ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ í¬í•¨)
   - `expenses`

### 4.2 ì¹´í…Œê³ ë¦¬ ë°ì´í„° í™•ì¸
`categories` í…Œì´ë¸”ì„ í´ë¦­í•˜ì—¬ ë‹¤ìŒ ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸:
- ì‹ë¹„ (orange, Utensils)
- êµí†µë¹„ (blue, Car)
- ì‡¼í•‘ (purple, ShoppingCart)
- ê¸°íƒ€ (gray, MoreHorizontal)

## ğŸ”’ 5ë‹¨ê³„: RLS ì •ì±… í™•ì¸

### 5.1 Authentication ì„¤ì •
1. ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ "Authentication" í´ë¦­
2. "Settings" íƒ­ì—ì„œ ë‹¤ìŒ ì„¤ì • í™•ì¸:
   - **Enable email confirmations**: í•„ìš”ì— ë”°ë¼ ì„¤ì •
   - **Enable phone confirmations**: ì¼ë°˜ì ìœ¼ë¡œ ë¹„í™œì„±í™”

### 5.2 RLS ì •ì±… í™•ì¸
1. "SQL Editor"ì—ì„œ ë‹¤ìŒ ì¿¼ë¦¬ ì‹¤í–‰:
```sql
SELECT schemaname, tablename, rowsecurity 
FROM pg_tables 
WHERE schemaname = 'public';
```

2. `users`ì™€ `expenses` í…Œì´ë¸”ì˜ `rowsecurity`ê°€ `t`(true)ì¸ì§€ í™•ì¸

## ğŸŒ 6ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### 6.1 .env íŒŒì¼ ìƒì„±
í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±:

```env
VITE_SUPABASE_URL=https://your-project-id.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-public-key
```

### 6.2 ë³´ì•ˆ ì£¼ì˜ì‚¬í•­
- `.env` íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš” (`.gitignore`ì— í¬í•¨ë¨)
- `anon` í‚¤ë§Œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©í•˜ì„¸ìš”
- ë°°í¬ì‹œì—ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •í•˜ì„¸ìš”

## ğŸ§ª 7ë‹¨ê³„: ì—°ê²° í…ŒìŠ¤íŠ¸

### 7.1 ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
npm run dev
```

### 7.2 ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
1. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:3000` ì ‘ì†
2. "ì§€ì¶œ ì¶”ê°€" íƒ­ì—ì„œ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì…ë ¥:
   - ì¹´í…Œê³ ë¦¬: ì‹ë¹„
   - ê¸ˆì•¡: 5000
   - ë©”ëª¨: í…ŒìŠ¤íŠ¸ ì»¤í”¼
3. "ì§€ì¶œ ì¶”ê°€í•˜ê¸°" í´ë¦­
4. "ë‚´ì—­" íƒ­ì—ì„œ ë°ì´í„°ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### 7.3 Supabaseì—ì„œ ë°ì´í„° í™•ì¸
1. Supabase "Table Editor"ì—ì„œ `expenses` í…Œì´ë¸” í´ë¦­
2. ë°©ê¸ˆ ì¶”ê°€í•œ ë°ì´í„°ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜ì™€ í•´ê²°ë°©ë²•

#### 1. "Invalid API key" ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
1. .env íŒŒì¼ì˜ í‚¤ ê°’ ì¬í™•ì¸
2. Supabase ëŒ€ì‹œë³´ë“œì—ì„œ í‚¤ ë‹¤ì‹œ ë³µì‚¬
3. ê°œë°œ ì„œë²„ ì¬ì‹œì‘ (npm run dev)
```

#### 2. "Row Level Security" ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
1. ìŠ¤í‚¤ë§ˆê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸
2. RLS ì •ì±…ì´ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ SQL Editorì—ì„œ í™•ì¸
3. ì¸ì¦ì´ í•„ìš”í•œ ê²½ìš° Authentication ì„¤ì • í™•ì¸
```

#### 3. "Relation does not exist" ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
1. í…Œì´ë¸”ì´ ëª¨ë‘ ìƒì„±ë˜ì—ˆëŠ”ì§€ Table Editorì—ì„œ í™•ì¸
2. ìŠ¤í‚¤ë§ˆ ì „ì²´ë¥¼ ë‹¤ì‹œ ì‹¤í–‰
3. í…Œì´ë¸”ëª… ì˜¤íƒ€ í™•ì¸
```

#### 4. CORS ì˜¤ë¥˜
```
í•´ê²°ë°©ë²•:
1. Supabase > Settings > APIì—ì„œ URL í™•ì¸
2. localhost:3000ì´ í—ˆìš©ëœ ë„ë©”ì¸ì¸ì§€ í™•ì¸
3. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ í›„ ì¬ì‹œë„
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ì¸ë±ìŠ¤ ìµœì í™”
ìŠ¤í‚¤ë§ˆì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì¸ë±ìŠ¤:
- `idx_expenses_user_id`: ì‚¬ìš©ìë³„ ì§€ì¶œ ì¡°íšŒ
- `idx_expenses_user_date`: ì‚¬ìš©ìë³„ ë‚ ì§œ ì¡°íšŒ
- `idx_expenses_expense_date`: ë‚ ì§œë³„ ì§‘ê³„

### ì¿¼ë¦¬ ìµœì í™” íŒ
1. ì›”ë³„ ë°ì´í„° ì¡°íšŒì‹œ ë‚ ì§œ ë²”ìœ„ ì œí•œ
2. í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì„ íƒí•˜ì—¬ ì¡°íšŒ
3. ì¡°ì¸ ì¿¼ë¦¬ ìµœì†Œí™”

## ğŸ”„ ë°±ì—… ë° ë³µì›

### ì •ê¸° ë°±ì—… ì„¤ì •
1. Supabase > Settings > Database
2. "Point in Time Recovery" í™œì„±í™” (Pro í”Œëœ ì´ìƒ)
3. ì •ê¸°ì ì¸ SQL ë¤í”„ ìƒì„± ê¶Œì¥

### ë°ì´í„° ë‚´ë³´ë‚´ê¸°
```sql
-- ì „ì²´ ì§€ì¶œ ë°ì´í„° CSV ë‚´ë³´ë‚´ê¸°
COPY (
  SELECT e.*, c.name as category_name 
  FROM expenses e 
  JOIN categories c ON e.category_id = c.id
) TO '/tmp/expenses_backup.csv' WITH CSV HEADER;
```

---

## ğŸ“ ì¶”ê°€ ì§€ì›

- [Supabase ê³µì‹ ë¬¸ì„œ](https://supabase.com/docs)
- [Supabase ì»¤ë®¤ë‹ˆí‹°](https://github.com/supabase/supabase/discussions)
- í”„ë¡œì íŠ¸ ì´ìŠˆëŠ” GitHub Issuesì— ë“±ë¡

ì„¤ì • ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì–¸ì œë“ ì§€ ë¬¸ì˜í•´ì£¼ì„¸ìš”! ğŸ™‚ 